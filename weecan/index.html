

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Weecan Login</title>
<style>
body {
font-family: "Segoe UI", sans-serif;
background: linear-gradient(135deg, #c9e4ff, #e6f0fa);
height: 100vh;
margin: 0;
display: flex;
justify-content: center;
align-items: center;
}
.login-box {
background: #fff;
padding: 30px 40px;
border-radius: 15px;
box-shadow: 0 5px 20px rgba(0,0,0,0.1);
width: 320px;
text-align: center;
}
.logo {
  width: 100px;
  margin-bottom: 8px;  /* 原本 15px，缩小一点 */
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.login-box h2 {
  margin-top: 5px;     /* 新增，避免默认 20px 的大间距 */
  margin-bottom: 20px;
  color: #1a3d66;
}

button {
width: 100%;
padding: 12px;
background: #7cc6ff;
border: none;
color: #fff;
font-size: 16px;
border-radius: 10px;
cursor: pointer;
margin-top: 12px;
}
button:hover {
background: #2980b9;
}
.error {
color: red;
margin-top: 10px;
font-size: 14px;
}
</style>
</head>
<body>
<div class="login-box">
<!-- Logo 图片 -->
<img src="images/logo.png" alt="" class="logo">


<h2>Weecan Login</h2>
<input type="text" id="username" placeholder="用户名">
<input type="password" id="password" placeholder="密码">
<button onclick="login()">登录</button>
<p id="errorMsg" class="error"></p>
</div>

<script>
const API_URL = "https://weecan-airtable-api.vercel.app/api/login";

async function login() {
const user = document.getElementById("username").value.trim();
const pass = document.getElementById("password").value.trim();
const errorMsg = document.getElementById("errorMsg");

console.log("🔍 Debug: 即将发送登录请求", { user, passHidden: pass ? "***" : "(空)" });
errorMsg.textContent = "";

try {
const res = await fetch(API_URL, {
method: "POST",
headers: { "Content-Type": "application/json" },
body: JSON.stringify({ user, pass })
});

console.log("📡 Debug: 收到响应状态", res.status);

let data;
try {
data = await res.json();
} catch (e) {
console.error("❌ Debug: JSON 解析失败", e);
errorMsg.textContent = "返回不是有效的 JSON";
return;
}

console.log("📦 Debug: 响应内容", data);

if (data.success) {
console.log("✅ Debug: 登录成功");
sessionStorage.setItem("loggedIn", "true");
alert("登录成功");
window.location.href = "main.html";
} else {
console.warn("⚠️ Debug: 登录失败，API 返回错误");
errorMsg.textContent = "❌ 用户名或密码错误";
}
} catch (err) {
console.error("🚨 Debug: 请求失败", err);
errorMsg.textContent = "🚨 登录失败，请稍后再试";
}
}
</script>

</body>
</html>

